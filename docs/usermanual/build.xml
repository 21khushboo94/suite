<project name="doc.usermanual" default="build">

    <import file="../common.xml"/>
     
     <target name="build-html"
             description="Build html docs">
       <antcall target="sphinx">
         <param name="dir" value="${basedir}/source"/>
         <param name="outdir" value="${basedir}/target/html"/>
         <param name="doctrees" value="${basedir}/target/doctrees"/>
         <param name="flags" value="-q -j 4 -W"/>
       </antcall>
     </target>

     <target name="build-text"
       description="Build text docs">
       <antcall target="sphinx">
         <param name="dir" value="${basedir}/source"/>
         <param name="outdir" value="${basedir}/target/basic"/>
         <param name="doctrees" value="${basedir}/target/doctrees"/>
         <param name="builder" value="text"/>
         <param name="flags" value="-q -j 4 -W"/>
       </antcall>
     </target>
  
     <target name="build-pdf" depends="check-pdf"
       description="Build pdf docs">
       <if>
           <equals arg1="${pdflatex.isPresent}" arg2="true"/>
           <then>
             <sequential>
               <copy todir="${basedir}/target/latex">
                 <fileset dir="${basedir}/../themes/suite_rtd_theme/static/img/">
                 <include name="**/opengeo-logo-only-blue.png"/>
                 </fileset>
               </copy>
               <antcall target="sphinx">
                 <param name="dir" value="${basedir}/source"/>
                 <param name="outdir" value="${basedir}/target/latex"/>
                 <param name="doctrees" value="${basedir}/target/doctrees"/>
                 <param name="builder" value="latex"/>
                 <param name="flags" value="-q -j 4 -W"/>
               </antcall>
               <exec executable="make" failonerror="true" dir="target/latex">
                 <arg line="all-pdf"/>
               </exec>
             </sequential>
           </then>
           <else>
               <echo message="No PDF generated because pdflatex is not on PATH.  This may make installer assembly fail."/>
           </else>
       </if>
     </target>
  
    <target name="build" depends="init">
      <antcall target="build-html"/>
      <antcall target="build-pdf"/>
    </target>

    <target name="clean" depends="destroy">
       <delete dir="target"/>
    </target>
  
</project>
