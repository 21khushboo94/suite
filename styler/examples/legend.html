<html>
<head>
    <title>Legend Panel</title>
    <link rel="stylesheet" type="text/css" href="../externals/ext/resources/css/ext-all.css" />
    <link rel="stylesheet" type="text/css" href="../externals/ux/colorpicker/color-picker.ux.css" />
    <link rel="stylesheet" type="text/css" href="../externals/ext/resources/css/xtheme-gray.css" />
    <link rel="stylesheet" type="text/css" href="../externals/openlayers/theme/default/style.css" />
    <link rel="stylesheet" type="text/css" href="../theme/css/styler.css" />
    
    <script type="text/javascript" src="../externals/ext/adapter/ext/ext-base.js"></script>
    <script type="text/javascript" src="../externals/ext/ext-all.js"></script>
    <script type="text/javascript" src="../externals/ux/colorpicker/color-picker.ux.js"></script>
    <script type="text/javascript" src="../script/OpenLayers.js"></script>
    <script type="text/javascript" src="../script/Styler.js"></script>
    <style type="text/css">
        .legend {
            width: 270px;
            margin: 1em 3em;
        }
    </style>    
    <script>
    
    Ext.BLANK_IMAGE_URL = "../externals/core/theme/images/default/s.gif";

    var rules = [
        new OpenLayers.Rule({
            title: "One Rule",
            symbolizer: {
                "Polygon": {
                    fillColor: "yellow",
                    fillOpacity: 0.5,
                    strokeColor: "blue",
                    strokeWidth: 2
                }
            }
        }),
        new OpenLayers.Rule({
            title: "Another Rule",
            symbolizer: {
                "Polygon": {
                    fillColor: "olive",
                    fillOpacity: 0.5,
                    strokeColor: "black",
                    strokeWidth: 1
                }
            }
        }),
        new OpenLayers.Rule({
            title: "And Another Rule",
            symbolizer: {
                "Polygon": {
                    fillColor: "green",
                    fillOpacity: 0.5,
                    strokeColor: "#333333",
                    strokeWidth: 1,
                    strokeDashstyle: "dot"
                }
            }
        })
    ];
    
    Ext.onReady(function() {
        new Styler.LegendPanel({
            title: "Simple Legend Panel",
            renderTo: "panel1",
            rules: rules,
            symbolType: "Polygon",
            bodyStyle: {padding: 5}
        });
        
        new Styler.LegendPanel({
            title: "Legend with Editable Symbols",
            renderTo: "panel2",
            rules: rules,
            symbolType: "Polygon",
            clickableSymbol: true,
            bodyStyle: {padding: 5},
            listeners: {
                symbolclick: function(comp, rule) {
                    showEditor(comp, rule);
                }
            }
        });
    });

    var symWin;
    function showEditor(legend, rule) {
        if(symWin) {
            symWin.destroy();
        }
        symWin = new Ext.Window({
            title: "Edit Symbol",
            plain: true,
            closeAction: "hide",
            items: [{
                xtype: "gx_polygonsymbolizer",
                symbolizer: rule.symbolizer["Polygon"],
                bodyStyle: {padding: 10},
                border: false,
                defaults: {
                    labelWidth: 50,
                    labelAlign: "right"
                },
                listeners: {
                    change: function(symbolizer) {
                        // we let the editor modify the original
                        // so, no need to update the rule
                        legend.update();
                    }
                }
            }]
        });
        symWin.show();
    }

    
    </script>
</head>
<body>
    <h1>Styler.LegendPanel</h1>
    <p>A basic legend panel showing symbolizers for mutiple rules (given a single geometry type).</p>
    <div id="panel1" class="legend"></div>
    <p>A legend panel that demonstrates how symbolizers can be made clickable (to launch a symbol editor).</p>
    <div id="panel2" class="legend"></div>
</body>
</html>
